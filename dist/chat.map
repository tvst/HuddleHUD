{"version":3,"file":"chat.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://nyanchat/./src/chat.js"],"sourcesContent":["const MSG_REMOVE_TIMEOUT_MS = 60000\nconst WRAPPER_HIDE_TIMEOUT_MS = 15000\n\nlet wrapper, messageListEl, inputBox\n\n// Functions\n\nfunction drawInterface() {\n  wrapper = document.createElement(\"div\")\n  wrapper.id = \"nyanChat\"\n  wrapper.style.display = \"none\"\n\n  messageListEl = document.createElement(\"ul\")\n  wrapper.appendChild(messageListEl)\n\n  inputBox = document.createElement(\"input\")\n  inputBox.style.display = \"none\"\n\n  inputBox.addEventListener(\"blur\", (event) => {\n    window.setTimeout(maybeHideWrapper, WRAPPER_HIDE_TIMEOUT_MS)\n  })\n\n  inputBox.addEventListener(\"keydown\", (event) => {\n    if (event.key == \"Enter\") {\n      chrome.runtime.sendMessage({\n        command: \"say\",\n        msgContents: inputBox.value,\n        url: getCleanUrl(),\n      })\n\n      inputBox.value = \"\"\n    }\n  })\n\n  wrapper.appendChild(inputBox)\n\n  document.body.appendChild(wrapper)\n}\n\nfunction showWrapper() {\n  wrapper.style.display = \"\"\n}\n\nfunction hideWrapper() {\n  wrapper.style.display = \"none\"\n}\n\nfunction maybeHideWrapper() {\n  if (messageListEl.children.length == 0) {\n    hideWrapper()\n  }\n}\n\nfunction showInputBox() {\n  inputBox.style.display = \"\"\n  showWrapper()\n  inputBox.focus()\n}\n\nfunction hideInputBox() {\n  inputBox.style.display = \"none\"\n  maybeHideWrapper()\n}\n\nfunction drawMessage({nick, msgContents}) {\n  console.log(\"Drawing:\", nick, msgContents)\n\n  const msgEl = document.createElement(\"li\")\n  msgEl.innerText = `[${nick}] ${msgContents}`\n  messageListEl.appendChild(msgEl)\n\n  showWrapper()\n\n  setTimeout(() => {\n    msgEl.remove()\n    setTimeout(maybeHideWrapper, WRAPPER_HIDE_TIMEOUT_MS)\n  }, MSG_REMOVE_TIMEOUT_MS)\n}\n\nfunction getCleanUrl() {\n  return `${document.location.hostname}/${document.location.pathname}`\n}\n\n\n// Initialization\n\nconst isRootFrame = window.parent === window\n\nif (isRootFrame) {\n  drawInterface()\n\n  document.addEventListener(\"keydown\", (event) => {\n    if (event.ctrlKey && event.key == \",\") {\n      console.log(\"Ctrl-,\")\n      showInputBox()\n    }\n  })\n\n  document.addEventListener(\"onunload\", (event) => {\n    chrome.runtime.sendMessage({\n      command: \"unsubscribe\",\n      url: getCleanUrl(),\n    })\n  })\n\n  chrome.runtime.onMessage.addListener((msg, sender, response) => {\n    console.log(\"onMessage\", msg)\n\n    switch (msg.command) {\n      case \"onNewMessage\": {\n        drawMessage(msg.data)\n      }\n    }\n\n    return true\n  })\n\n  chrome.runtime.sendMessage({\n    command: \"subscribe\",\n    url: getCleanUrl(),\n  })\n}\n"],"names":[],"sourceRoot":""}