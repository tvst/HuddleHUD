{"version":3,"file":"chat.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://HuddleHUD/./src/chat.js"],"sourcesContent":["const MSG_REMOVE_TIMEOUT_MS = 180000\nconst WRAPPER_HIDE_TIMEOUT_MS = 15000\n\nlet wrapper, messageListEl, inputBox\n\n// Functions\n\nfunction drawInterface() {\n  wrapper = document.createElement(\"div\")\n  wrapper.id = \"HuddleHUD\"\n  wrapper.style.display = \"none\"\n\n  messageListEl = document.createElement(\"ul\")\n  wrapper.appendChild(messageListEl)\n\n  inputBox = document.createElement(\"input\")\n\n  inputBox.addEventListener(\"blur\", (event) => {\n    window.setTimeout(maybeHideWrapper, WRAPPER_HIDE_TIMEOUT_MS)\n  })\n\n  inputBox.addEventListener(\"keydown\", (event) => {\n    switch (event.key) {\n      case \"Esc\":\n      case \"Escape\": {\n        hideWrapper()\n      }\n      break\n\n      case \"Enter\": {\n        const msgContents = inputBox.value.trim()\n\n        if (msgContents.length) {\n          chrome.runtime.sendMessage({\n            command: \"say\",\n            msgContents,\n            url: document.location.href,\n          })\n        }\n\n        inputBox.value = \"\"\n      }\n      break\n    }\n  })\n\n  wrapper.appendChild(inputBox)\n\n  document.body.appendChild(wrapper)\n}\n\nfunction showWrapper() {\n  wrapper.style.display = \"\"\n}\n\nfunction hideWrapper() {\n  wrapper.style.display = \"none\"\n}\n\nfunction maybeHideWrapper() {\n  if (messageListEl.children.length == 0) {\n    hideWrapper()\n  }\n}\n\nfunction drawMessage({nick, msgContents}) {\n  console.log(\"Drawing:\", nick, msgContents)\n\n  const msgEl = document.createElement(\"li\")\n  msgEl.style.color = getColor(nick)\n  msgEl.innerText = `${nick}: ${msgContents}`\n  messageListEl.appendChild(msgEl)\n\n  showWrapper()\n\n  setTimeout(() => {\n    msgEl.remove()\n    setTimeout(maybeHideWrapper, WRAPPER_HIDE_TIMEOUT_MS)\n  }, MSG_REMOVE_TIMEOUT_MS)\n\n  setTimeout(hideWrapper, WRAPPER_HIDE_TIMEOUT_MS)\n}\n\nconst COLORS = [\n  \"#ff4444\",\n  \"#44ff44\",\n  \"#4444ff\",\n  \"#ffff44\",\n  \"#44ffff\",\n  \"#ff44ff\",\n]\n\nconst colorAssignments = new Map();\n\nfunction getColor(str) {\n  if (colorAssignments.has(str)) {\n    return colorAssignments.get(str)\n  }\n\n  const color = COLORS[colorAssignments.size]\n  colorAssignments.set(str, color)\n  return color\n}\n\n\n// Initialization\n\nconst isRootFrame = window.parent === window\n\nif (isRootFrame) {\n  drawInterface()\n\n  document.addEventListener(\"keydown\", (event) => {\n    if (event.ctrlKey && event.key == \",\") {\n      showWrapper()\n      inputBox.focus()\n    }\n  })\n\n  document.addEventListener(\"onunload\", (event) => {\n    chrome.runtime.sendMessage({\n      command: \"unsubscribe\",\n      url: document.location.href,\n    })\n  })\n\n  chrome.runtime.onMessage.addListener((msg, sender, response) => {\n    console.log(\"onMessage\", msg)\n\n    switch (msg.command) {\n      case \"onNewMessage\": {\n        drawMessage(msg.data)\n      }\n    }\n\n    return true\n  })\n\n  chrome.runtime.sendMessage({\n    command: \"subscribe\",\n    url: document.location.href,\n  })\n}\n"],"names":[],"sourceRoot":""}